Loading Mobile dataset
Loading Mobile dataset
(5852925, 50) (1530035, 50) (5852925,) (1530035,)
Iteration 1, loss = 0.36566701
Validation score: 0.040640
Iteration 2, loss = 0.29880397
Validation score: 0.114527
Iteration 3, loss = 0.28394066
Validation score: 0.139678
Iteration 4, loss = 0.27499839
Validation score: 0.164603
Iteration 5, loss = 0.26749716
Validation score: 0.186325
Iteration 6, loss = 0.26065294
Validation score: 0.206858
Iteration 7, loss = 0.25419915
Validation score: 0.226081
Iteration 8, loss = 0.24828057
Validation score: 0.243117
Iteration 9, loss = 0.24313488
Validation score: 0.257718
Iteration 10, loss = 0.23872208
Validation score: 0.270355
Iteration 11, loss = 0.23485542
Validation score: 0.281522
Iteration 12, loss = 0.23145278
Validation score: 0.291447
Iteration 13, loss = 0.22837398
Validation score: 0.300656
Iteration 14, loss = 0.22546928
Validation score: 0.309387
Iteration 15, loss = 0.22264943
Validation score: 0.318042
Iteration 16, loss = 0.21987121
Validation score: 0.326515
Iteration 17, loss = 0.21716655
Validation score: 0.334803
Iteration 18, loss = 0.21451355
Validation score: 0.343146
Iteration 19, loss = 0.21185522
Validation score: 0.351131
Iteration 20, loss = 0.20929849
Validation score: 0.358954
Iteration 21, loss = 0.20681031
Validation score: 0.366248
Iteration 22, loss = 0.20441100
Validation score: 0.373777
Iteration 23, loss = 0.20217300
Validation score: 0.380349
Iteration 24, loss = 0.19997459
Validation score: 0.386706
Iteration 25, loss = 0.19774884
Validation score: 0.394124
Iteration 26, loss = 0.19564337
Validation score: 0.400298
Iteration 27, loss = 0.19362273
Validation score: 0.405962
Iteration 28, loss = 0.19171639
Validation score: 0.411392
Iteration 29, loss = 0.19024598
Validation score: 0.416434
Iteration 30, loss = 0.18819013
Validation score: 0.422607
Iteration 31, loss = 0.18654186
Validation score: 0.427004
Iteration 32, loss = 0.18512997
Validation score: 0.432456
Iteration 33, loss = 0.18357566
Validation score: 0.436087
Iteration 34, loss = 0.18190412
Validation score: 0.441539
Iteration 35, loss = 0.18050615
Validation score: 0.444401
Iteration 36, loss = 0.17963325
Validation score: 0.450004
Iteration 37, loss = 0.17791622
Validation score: 0.453912
Iteration 38, loss = 0.17683080
Validation score: 0.456513
Iteration 39, loss = 0.17544563
Validation score: 0.460928
Iteration 40, loss = 0.17444530
Validation score: 0.463947
Iteration 41, loss = 0.17309269
Validation score: 0.468372
Iteration 42, loss = 0.17209446
Validation score: 0.471389
Iteration 43, loss = 0.17084760
Validation score: 0.474948
Iteration 44, loss = 0.17035098
Validation score: 0.477417
Iteration 45, loss = 0.16898264
Validation score: 0.480814
Iteration 46, loss = 0.16820260
Validation score: 0.481967
Iteration 47, loss = 0.16727011
Validation score: 0.484466
Iteration 48, loss = 0.16637747
Validation score: 0.489146
Iteration 49, loss = 0.16571984
Validation score: 0.491859
Iteration 50, loss = 0.16500885
Validation score: 0.494140
Iteration 51, loss = 0.16375042
Validation score: 0.495525
Iteration 52, loss = 0.16299292
Validation score: 0.498957
Iteration 53, loss = 0.16220124
Validation score: 0.499703
Iteration 54, loss = 0.16162114
Validation score: 0.502544
Iteration 55, loss = 0.16085927
Validation score: 0.506518
Iteration 56, loss = 0.15985162
Validation score: 0.508497
Iteration 57, loss = 0.15954380
Validation score: 0.504988
Iteration 58, loss = 0.15901488
Validation score: 0.512560
Iteration 59, loss = 0.15797233
Validation score: 0.515044
Iteration 60, loss = 0.15736217
Validation score: 0.513876
Iteration 61, loss = 0.15704379
Validation score: 0.518426
Iteration 62, loss = 0.15591110
Validation score: 0.520859
Iteration 63, loss = 0.15542046
Validation score: 0.522658
Iteration 64, loss = 0.15486023
Validation score: 0.523185
Iteration 65, loss = 0.15467751
Validation score: 0.525202
Iteration 66, loss = 0.15400701
Validation score: 0.526351
Iteration 67, loss = 0.15308562
Validation score: 0.529202
Iteration 68, loss = 0.15244675
Validation score: 0.528042
Iteration 69, loss = 0.15373002
Validation score: 0.532091
Iteration 70, loss = 0.15230443
Validation score: 0.530100
Iteration 71, loss = 0.15133609
Validation score: 0.534419
Iteration 72, loss = 0.15058843
Validation score: 0.536888
Iteration 73, loss = 0.14999675
Validation score: 0.538221
Iteration 74, loss = 0.14947569
Validation score: 0.539798
Iteration 75, loss = 0.14910845
Validation score: 0.540791
Iteration 76, loss = 0.14863366
Validation score: 0.541851
Iteration 77, loss = 0.14816997
Validation score: 0.542425
Iteration 78, loss = 0.14874096
Validation score: 0.542787
Iteration 79, loss = 0.14762641
Validation score: 0.546632
Iteration 80, loss = 0.14690879
Validation score: 0.547869
Iteration 81, loss = 0.14674316
Validation score: 0.549211
Iteration 82, loss = 0.14635556
Validation score: 0.545220
Iteration 83, loss = 0.14608881
Validation score: 0.551848
Iteration 84, loss = 0.14516603
Validation score: 0.552966
Iteration 85, loss = 0.14490109
Validation score: 0.551048
Iteration 86, loss = 0.14514220
Validation score: 0.555213
Iteration 87, loss = 0.14515248
Validation score: 0.553585
Iteration 88, loss = 0.14438125
Validation score: 0.557630
Iteration 89, loss = 0.14327400
Validation score: 0.558910
Iteration 90, loss = 0.14328984
Validation score: 0.557321
Iteration 91, loss = 0.14269479
Validation score: 0.560263
Iteration 92, loss = 0.14224448
Validation score: 0.561314
Iteration 93, loss = 0.14193054
Validation score: 0.563198
Iteration 94, loss = 0.14162069
Validation score: 0.562234
Iteration 95, loss = 0.14132994
Validation score: 0.565649
Iteration 96, loss = 0.14081776
Validation score: 0.564009
Iteration 97, loss = 0.14117545
Validation score: 0.566412
Iteration 98, loss = 0.14025739
Validation score: 0.565532
Iteration 99, loss = 0.14020345
Validation score: 0.568119
Iteration 100, loss = 0.13961985
Validation score: 0.568499
Iteration 101, loss = 0.13960659
Validation score: 0.570446
Iteration 102, loss = 0.13943928
Validation score: 0.569036
Iteration 103, loss = 0.13951380
Validation score: 0.570024
Iteration 104, loss = 0.13866821
Validation score: 0.573937
Iteration 105, loss = 0.13785700
Validation score: 0.573346
Iteration 106, loss = 0.13777801
Validation score: 0.574659
Iteration 107, loss = 0.13748585
Validation score: 0.577045
Iteration 108, loss = 0.13812523
Validation score: 0.576935
Iteration 109, loss = 0.13767004
Validation score: 0.578228
Iteration 110, loss = 0.13662208
Validation score: 0.577888
Iteration 111, loss = 0.13615899
Validation score: 0.580533
Iteration 112, loss = 0.13569333
Validation score: 0.581897
Iteration 113, loss = 0.13549336
Validation score: 0.581618
Iteration 114, loss = 0.13527218
Validation score: 0.583480
Iteration 115, loss = 0.13515235
Validation score: 0.582373
Iteration 116, loss = 0.13517991
Validation score: 0.582924
Iteration 117, loss = 0.13467266
Validation score: 0.585696
Iteration 118, loss = 0.13425517
Validation score: 0.586575
Iteration 119, loss = 0.13483540
Validation score: 0.573957
Iteration 120, loss = 0.13470379
Validation score: 0.586638
Iteration 121, loss = 0.13372026
Validation score: 0.587154
Iteration 122, loss = 0.13337357
Validation score: 0.589295
Iteration 123, loss = 0.13295807
Validation score: 0.589658
Iteration 124, loss = 0.13263011
Validation score: 0.591217
Iteration 125, loss = 0.13247386
Validation score: 0.589882
Iteration 126, loss = 0.13219675
Validation score: 0.592720
Iteration 127, loss = 0.13222457
Validation score: 0.589973
Iteration 128, loss = 0.13198181
Validation score: 0.592930
Iteration 129, loss = 0.13153895
Validation score: 0.593346
Iteration 130, loss = 0.13158957
Validation score: 0.593860
Iteration 131, loss = 0.13116381
Validation score: 0.597153
Iteration 132, loss = 0.13080109
Validation score: 0.597596
Iteration 133, loss = 0.13043049
Validation score: 0.597684
Iteration 134, loss = 0.13092523
Validation score: 0.594871
Iteration 135, loss = 0.13043215
Validation score: 0.597925
Iteration 136, loss = 0.12990402
Validation score: 0.598404
Iteration 137, loss = 0.13021506
Validation score: 0.601512
Iteration 138, loss = 0.12911808
Validation score: 0.602058
Iteration 139, loss = 0.12957436
Validation score: 0.598534
Iteration 140, loss = 0.12915572
Validation score: 0.603430
Iteration 141, loss = 0.12848498
Validation score: 0.604080
Iteration 142, loss = 0.12829087
Validation score: 0.603692
Iteration 143, loss = 0.12803656
Validation score: 0.605473
Iteration 144, loss = 0.12815868
Validation score: 0.599494
Iteration 145, loss = 0.12832867
Validation score: 0.606574
Iteration 146, loss = 0.12798979
Validation score: 0.605915
Iteration 147, loss = 0.12747408
Validation score: 0.607111
Iteration 148, loss = 0.12726940
Validation score: 0.608526
Iteration 149, loss = 0.12691935
Validation score: 0.608764
Iteration 150, loss = 0.12728190
Validation score: 0.603231
Iteration 151, loss = 0.12732487
Validation score: 0.608883
Iteration 152, loss = 0.12670045
Validation score: 0.608079
Iteration 153, loss = 0.12614132
Validation score: 0.611406
Iteration 154, loss = 0.12596355
Validation score: 0.610380
Iteration 155, loss = 0.12551154
Validation score: 0.612933
Iteration 156, loss = 0.12546238
Validation score: 0.611968
Iteration 157, loss = 0.12533951
Validation score: 0.612312
Iteration 158, loss = 0.12492522
Validation score: 0.614823
Iteration 159, loss = 0.12481665
Validation score: 0.604591
Iteration 160, loss = 0.12850720
Validation score: 0.606358
Iteration 161, loss = 0.12526910
Validation score: 0.615726
Iteration 162, loss = 0.12428173
Validation score: 0.617174
Iteration 163, loss = 0.12432729
Validation score: 0.616109
Iteration 164, loss = 0.12397827
Validation score: 0.618643
Iteration 165, loss = 0.12367306
Validation score: 0.618481
Iteration 166, loss = 0.12343276
Validation score: 0.618830
Iteration 167, loss = 0.12375127
Validation score: 0.615817
Iteration 168, loss = 0.12356484
Validation score: 0.620016
Iteration 169, loss = 0.12311605
Validation score: 0.621793
Iteration 170, loss = 0.12289154
Validation score: 0.615507
Iteration 171, loss = 0.12324581
Validation score: 0.622054
Iteration 172, loss = 0.12226162
Validation score: 0.623193
Iteration 173, loss = 0.12215799
Validation score: 0.623911
Iteration 174, loss = 0.12206698
Validation score: 0.623319
Iteration 175, loss = 0.12172130
Validation score: 0.624676
Iteration 176, loss = 0.12172821
Validation score: 0.624043
Iteration 177, loss = 0.12187996
Validation score: 0.624723
Iteration 178, loss = 0.12128399
Validation score: 0.626169
Iteration 179, loss = 0.12192447
Validation score: 0.625914
Iteration 180, loss = 0.12098196
Validation score: 0.626842
Iteration 181, loss = 0.12076416
Validation score: 0.628308
Iteration 182, loss = 0.12045859
Validation score: 0.626081
Iteration 183, loss = 0.12320155
Validation score: 0.624773
Iteration 184, loss = 0.12092791
Validation score: 0.629907
Iteration 185, loss = 0.12013450
Validation score: 0.628912
Iteration 186, loss = 0.11993750
Validation score: 0.630139
Iteration 187, loss = 0.11983734
Validation score: 0.631228
Iteration 188, loss = 0.11944495
Validation score: 0.631546
Iteration 189, loss = 0.11944635
Validation score: 0.631279
Iteration 190, loss = 0.12007805
Validation score: 0.629218
Iteration 191, loss = 0.11932624
Validation score: 0.633034
Iteration 192, loss = 0.12009324
Validation score: 0.633551
Iteration 193, loss = 0.11909208
Validation score: 0.633384
Iteration 194, loss = 0.11855616
Validation score: 0.634568
Iteration 195, loss = 0.11877035
Validation score: 0.634169
Iteration 196, loss = 0.11829113
Validation score: 0.635935
Iteration 197, loss = 0.11941571
Validation score: 0.633637
Iteration 198, loss = 0.11814886
Validation score: 0.636300
Iteration 199, loss = 0.11780947
Validation score: 0.636151
Iteration 200, loss = 0.11832515
Validation score: 0.633382
Training time: 7584.2984773833305 seconds
Prediction time: 3.7197568928822875 seconds
Average ARD:  0.13803108
Clark Error Grid Zone:  [0.7796143250688705, 0.21487603305785125, 0.0, 0.005509641873278237, 0.0]
Surveillance Error Grid Zone:  {'None': 74.65564738292011, 'Slight': 25.068870523415974, 'Moderate': 0.27548209366391185, 'Great': 0.0, 'Extreme': 0.0}


# VGG19
Loading Mobile dataset
Loading Mobile dataset
(1383, 50, 64, 64) (363, 50, 64, 64) (1383,) (363,)
Epoch 1/200 - Train Loss: 16788.1044 - Val Loss: 17581.1759
Epoch 2/200 - Train Loss: 15475.1912 - Val Loss: 16069.5313
Epoch 3/200 - Train Loss: 14194.9293 - Val Loss: 14442.4615
Epoch 4/200 - Train Loss: 12487.8597 - Val Loss: 12454.1986
Epoch 5/200 - Train Loss: 10556.2863 - Val Loss: 10127.8071
Epoch 6/200 - Train Loss: 8099.9578 - Val Loss: 7666.5624
Epoch 7/200 - Train Loss: 5993.7577 - Val Loss: 5396.0810
Epoch 8/200 - Train Loss: 4181.1778 - Val Loss: 3576.4166
Epoch 9/200 - Train Loss: 2768.8765 - Val Loss: 2390.6606
Epoch 10/200 - Train Loss: 2116.6066 - Val Loss: 1789.1378
Epoch 11/200 - Train Loss: 1776.3546 - Val Loss: 1540.6432
Epoch 12/200 - Train Loss: 1739.3776 - Val Loss: 1451.4107
Epoch 13/200 - Train Loss: 1645.3843 - Val Loss: 1408.0593
Epoch 14/200 - Train Loss: 1670.5773 - Val Loss: 1405.5752
Epoch 15/200 - Train Loss: 1640.6225 - Val Loss: 1398.9281
Epoch 16/200 - Train Loss: 1663.5730 - Val Loss: 1396.0501
Epoch 17/200 - Train Loss: 1650.6093 - Val Loss: 1392.3019
Epoch 18/200 - Train Loss: 1685.3870 - Val Loss: 1404.8995
Epoch 19/200 - Train Loss: 1649.6375 - Val Loss: 1400.8782
Epoch 20/200 - Train Loss: 1676.4731 - Val Loss: 1392.3600
Epoch 21/200 - Train Loss: 1647.8239 - Val Loss: 1398.0091
Epoch 22/200 - Train Loss: 1650.0595 - Val Loss: 1392.7037
Epoch 23/200 - Train Loss: 1687.5055 - Val Loss: 1398.6491
Epoch 24/200 - Train Loss: 1653.7763 - Val Loss: 1391.7788
Epoch 25/200 - Train Loss: 1653.1320 - Val Loss: 1406.7350
Epoch 26/200 - Train Loss: 1681.9373 - Val Loss: 1390.8311
Epoch 27/200 - Train Loss: 1672.9655 - Val Loss: 1399.2602
Epoch 28/200 - Train Loss: 1653.0108 - Val Loss: 1393.6171
Epoch 29/200 - Train Loss: 1649.7250 - Val Loss: 1383.5907
Epoch 30/200 - Train Loss: 1678.9641 - Val Loss: 1395.4522
Epoch 31/200 - Train Loss: 1689.5954 - Val Loss: 1394.2569
Epoch 32/200 - Train Loss: 1647.5144 - Val Loss: 1397.6854
Epoch 33/200 - Train Loss: 1648.9657 - Val Loss: 1390.5603
Epoch 34/200 - Train Loss: 1648.1411 - Val Loss: 1393.1384
Epoch 35/200 - Train Loss: 1652.1772 - Val Loss: 1389.1094
Epoch 36/200 - Train Loss: 1637.2154 - Val Loss: 1391.6430
Epoch 37/200 - Train Loss: 1676.3013 - Val Loss: 1396.6009
Epoch 38/200 - Train Loss: 1647.4387 - Val Loss: 1385.7464
Epoch 39/200 - Train Loss: 1685.1732 - Val Loss: 1395.7051
Early stopping triggered. No improvement for 10 consecutive epochs.
Training time: 213.52403680607677 seconds
Prediction time: 0.5539723439142108 seconds
Traceback (most recent call last):
  File "/local-scratch/GlucoseProject/mobicom23_mobispectral/regression/Architecture/Regression_Models.py", line 216, in <module>
    ard = ard_image(test_data, model)
  File "/local-scratch/GlucoseProject/mobicom23_mobispectral/regression/utils.py", line 273, in ard_image
    y_pred = model.predict(X_test)
  File "/local-scratch/GlucoseProject/mobicom23_mobispectral/regression/Architecture/VGG.py", line 113, in predict
    output = self.forward(x)
  File "/local-scratch/GlucoseProject/mobicom23_mobispectral/regression/Architecture/VGG.py", line 78, in forward
    x = self.stage1(x)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 142, in forward
    self._check_input_dim(input)
  File "/localhome/ngyikn/miniconda3/envs/Glucose/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 425, in _check_input_dim
    raise ValueError(f"expected 4D input (got {input.dim()}D input)")
ValueError: expected 4D input (got 3D input)
Loading Mobile dataset
Loading Mobile dataset
(5852925, 50) (1530035, 50) (5852925,) (1530035,)
SVR
Start fitting model...
End fitting model...
Average ARD:  0.14152380631517342
Clark Error Grid Zone:  [0.7575757575757576, 0.2369146005509642, 0.0, 0.005509641873278237, 0.0]
Surveillance Error Grid Zone:  {'None': 74.65564738292011, 'Slight': 25.068870523415974, 'Moderate': 0.27548209366391185, 'Great': 0.0, 'Extreme': 0.0}
